<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Student number: 23083053">

<title>Urban Simulation Report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="urban_simulation_report_files/libs/clipboard/clipboard.min.js"></script>
<script src="urban_simulation_report_files/libs/quarto-html/quarto.js"></script>
<script src="urban_simulation_report_files/libs/quarto-html/popper.min.js"></script>
<script src="urban_simulation_report_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="urban_simulation_report_files/libs/quarto-html/anchor.min.js"></script>
<link href="urban_simulation_report_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="urban_simulation_report_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="urban_simulation_report_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="urban_simulation_report_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="urban_simulation_report_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="..\urban_simulation_report.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Urban Simulation Report</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Student number: 23083053 </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="part-1-londons-underground-resilience" class="level2">
<h2 class="anchored" data-anchor-id="part-1-londons-underground-resilience">Part 1: London’s Underground Resilience</h2>
<p>The first part of this report aims to address the resilience of the London Underground using network analysis.</p>
<section id="topological-network" class="level3">
<h3 class="anchored" data-anchor-id="topological-network">Topological Network</h3>
<section id="centrality-measures" class="level4">
<h4 class="anchored" data-anchor-id="centrality-measures">Centrality Measures</h4>
<p>Centrality measures are characteristics of nodes showing their <em>importance</em> in various aspects. In this section, we will identify nodes on the network with the highest centrality in the following measurements: degree centrality, closeness centrality, and betweenness centrality. The 3 central measures that I will cover in this report are: degree centrality, betweenness centrality, and closeness centrality. We will consider a network of <span class="math inline">\(n\)</span> nodes, and the number of links between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> will be denoted as <span class="math inline">\(A_{ij}\)</span>.</p>
<p><strong>Degree centrality</strong> is the number of links that are connected to each node. Considering the underground as an undirected graph, the degree centrality <span class="math inline">\(k_i\)</span> for node <span class="math inline">\(i\)</span> is calculated as</p>
<p><span id="eq-degree-centrality"><span class="math display">\[
k_i = \sum_{j} A_{ij}
\tag{1}\]</span></span></p>
<p>In the context of the underground network, the degree corresponds to the number of lines that serve each station counting 1 for each direction. A high degree centrality indicates there are many lines that serve the station, thus identifies importance of the station as a transit hub that allows for transfer between multiple lines.</p>
<p>The stations with the highest degree centrality are shown in <a href="#tbl-degree">Table&nbsp;1</a>. These stations match the characteristics of being a large transfer station.</p>
<div id="tbl-degree" class="anchored">
<table class="table">
<caption>Table&nbsp;1: Stations with the highest degree centrality. All stations tied at a degree of 6 are listed.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Rank</th>
<th style="text-align: left;">Station</th>
<th style="text-align: right;">Degree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Stratford</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">Bank and Monument</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Baker Street</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Waterloo</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: left;">West Ham</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Canning Town</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Liverpool Street</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Earl’s Court</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Green Park</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Oxford Circus</td>
<td style="text-align: right;">6</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Betweenness centrality</strong> is defined by the number of shortest paths that run through the node (or link). The betweenness centrality <span class="math inline">\(x_i\)</span> can be calculated as</p>
<p><span id="eq-betweenness-centrality"><span class="math display">\[
x_i = \sum_{st} \frac{n^i_{st}}{g_{st}}
\tag{2}\]</span></span></p>
<p>where</p>
<p><span class="math display">\[
n^i_{st} =
\begin{cases}
1 \quad (\text{if node } i \text{ is on geodesic from } s \text{ to }t)\\
0 \quad (\text{otherwise})
\end{cases}
\]</span></p>
<p>and <span class="math inline">\(g_{st}\)</span> is the total number of geodesic paths from <span class="math inline">\(s\)</span> to <span class="math inline">\(t\)</span>. To normalised, the raw value should be divided by all possible combinations of shortest paths between the other <span class="math inline">\(n-1\)</span> nodes: <span class="math inline">\(\frac{(n-1)(n-2)}{2}\)</span>. High betweenness centrality on the underground shows there are many passengers travelling through the station during their journeys, which are stations en route of connecting the suburban areas with the city centre, or stations on short-distance routes. When this station becomes inaccessible, a large amount of people will be affected.</p>
<p>The stations with the highest betweenness centrality are shown in <a href="#tbl-betweenness">Table&nbsp;2</a>.</p>
<div id="tbl-betweenness" class="anchored">
<table class="table">
<caption>Table&nbsp;2: Stations with highest betweenness centrality.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Rank</th>
<th style="text-align: left;">Station</th>
<th style="text-align: right;">Betweenness Centrality</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Bank and Monument</td>
<td style="text-align: right;">17,602</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
<td style="text-align: right;">16,780</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Stratford</td>
<td style="text-align: right;">14,548</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Baker Street</td>
<td style="text-align: right;">13,200</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Oxford Circus</td>
<td style="text-align: right;">12,584</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Euston</td>
<td style="text-align: right;">12,401</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Earl’s Court</td>
<td style="text-align: right;">11,454</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">Shadwell</td>
<td style="text-align: right;">11,127</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Waterloo</td>
<td style="text-align: right;">10,407</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">South Kensington</td>
<td style="text-align: right;">10,304</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Closeness centrality</strong> is the inverse of the main geodesic distance <span class="math inline">\(l_i\)</span> of one node to all the other <span class="math inline">\(n-1\)</span> nodes. Given the geodesic distance between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> as <span class="math inline">\(d_{ij}\)</span>, the closeness centrality <span class="math inline">\(C_i\)</span> is calculated as</p>
<p><span id="eq-closeness-centrality"><span class="math display">\[
C_i = \frac{1}{l_i} = \frac{n-1}{\sum_{j} d_{ij}}
\tag{3}\]</span></span></p>
<p>A high closeness centrality in a rail network indicates the station is within a short distance from all the other stations, located at the physical centre of the network. Provided that the network spreads out radially from the city centre, the stations with highest closeness centrality are assumed to be located within the city centre, as illustrated by the high-ranked stations in London shown in <a href="#tbl-closeness">Table&nbsp;3</a>. These stations are located at the West End area - which can be assumed as the central area of London.</p>
<div id="tbl-closeness" class="anchored">
<table class="table">
<caption>Table&nbsp;3: Stations with the highest closeness centrality.</caption>
<thead>
<tr class="header">
<th style="text-align: right;">Rank</th>
<th style="text-align: left;">Station</th>
<th style="text-align: right;">Closeness Centrality <span class="math inline">\((\times 10^{-5})\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">Holborn</td>
<td style="text-align: right;">7.926</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
<td style="text-align: right;">7.914</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">Tottenham Court Road</td>
<td style="text-align: right;">7.891</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">Oxford Circus</td>
<td style="text-align: right;">7.883</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">Leicester Square</td>
<td style="text-align: right;">7.837</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">Picadilly Circus</td>
<td style="text-align: right;">7.834</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">Charing Cross</td>
<td style="text-align: right;">7.833</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">Chancery Lane</td>
<td style="text-align: right;">7.825</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">Covent Garden</td>
<td style="text-align: right;">7.810</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">Embankment</td>
<td style="text-align: right;">7.802</td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="impact-measures" class="level4">
<h4 class="anchored" data-anchor-id="impact-measures">Impact Measures</h4>
<p>For impact measurement, we considered the delta centrality, a concept introduced by <span class="citation" data-cites="latora2007">Latora and Marchiori (<a href="#ref-latora2007" role="doc-biblioref">2007</a>)</span> that compares the <em>performance</em> of the whole network when a node is removed from the network in question. For a performance measure <span class="math inline">\(P\)</span> of the network <span class="math inline">\(G\)</span>, the delta centrality <span class="math inline">\(C^{\Delta}_i\)</span> of node <span class="math inline">\(i\)</span> is defined as</p>
<p><span class="math display">\[
C^{\Delta}_i = \frac{\Delta P}{P} = \frac{P(G) - P(G')}{P(G)}
\]</span></p>
<p>where <span class="math inline">\(G'\)</span> denotes the network where node <span class="math inline">\(i\)</span> is removed. This can be applied to any performance measure <span class="math inline">\(P\)</span> - we have considered the measures summarised in <a href="#tbl-delta-performance">Table&nbsp;4</a>.</p>
<div id="tbl-delta-performance" class="anchored">
<table class="table">
<caption>Table&nbsp;4: Performance measures considered for delta centrality. The impact of node removal are measured through the change in these performance values.</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Performance Measure <span class="math inline">\(P\)</span></th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Size of Largest Connected Component</td>
<td>The size of the largest connected component shows the connectivity of the network. A smaller number indicates stations are disattached from the main network, leading to less connectivity.</td>
</tr>
<tr class="even">
<td>Network Efficiency</td>
<td>Efficiency measure proposed by <span class="citation" data-cites="latora2001">Latora and Marchiori (<a href="#ref-latora2001" role="doc-biblioref">2001</a>)</span>, calculated as <span class="math inline">\(E(G) = \frac{1}{n(n-1)}\sum_{i \ne j} \frac{1}{d_{ij}}\)</span>. A high value indicates a low average shortest path length between nodes, and a low value represents nodes are further apart or disconnected. Unlike the average shortest path length, this measure can be calculated for disconnected networks. Note the <code>nx.global_efficiency()</code> function cannot incorporate edge length, a custom function was defined to calculate this value.</td>
</tr>
</tbody>
</table>
</div>
<p>These measures can be applied to any transport network, especially the average shortest path length is directly addressing the puropose of transport systems of connecting different areas. The number of cycles also impact the resilience of transport networks, although may not be applicable for road networks that inherently have a large number of cycles. An applicable example of these measures outside the London underground is the destruction of the subway network in New York City after the September 11 attacks, which resulted in the closure of multiple stations and line segments <span class="citation" data-cites="wyatt2002 paaswell2012">(<a href="#ref-wyatt2002" role="doc-biblioref">Wyatt, 2002</a>; <a href="#ref-paaswell2012" role="doc-biblioref">Paaswell, 2012</a>)</span>.</p>
</section>
<section id="node-removal" class="level4">
<h4 class="anchored" data-anchor-id="node-removal">Node Removal</h4>
<p>The removal of nodes with high centrality and the impact on the performance of the network are considered. For each centrality measure, two strategies are used to remove 10 nodes from the network: a <strong>non-sequential</strong> strategy removes nodes in order that appears in the rank tables (<a href="#tbl-degree">Table&nbsp;1</a>; <a href="#tbl-betweenness">Table&nbsp;2</a>; <a href="#tbl-closeness">Table&nbsp;3</a>), while a <strong>sequential</strong> strategy removes the node with the highest centrality when recalculated after the previous node removal step. The stations removed for each centrality measure are shown in <a href="#tbl-removed-stations">Table&nbsp;5</a>.</p>
<div id="tbl-removed-stations" class="tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;5: Stations removed for impact assessment for each centrality measure and strategy. For each scenario, the stations were removed one at a time from the top of the table to the bottom.</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-removed-stations-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-removed-stations" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(a) Degree Centrality</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Non-sequential</th>
<th style="text-align: left;">Sequential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Stratford</td>
<td style="text-align: left;">Stratford</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bank and Monument</td>
<td style="text-align: left;">Bank and Monument</td>
</tr>
<tr class="odd">
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
<td style="text-align: left;">Baker Street</td>
</tr>
<tr class="even">
<td style="text-align: left;">Baker Street</td>
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Waterloo</td>
<td style="text-align: left;">Oxford Circus</td>
</tr>
<tr class="even">
<td style="text-align: left;">West Ham</td>
<td style="text-align: left;">Earl’s Court</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Canning Town</td>
<td style="text-align: left;">Canning Town</td>
</tr>
<tr class="even">
<td style="text-align: left;">Liverpool Street</td>
<td style="text-align: left;">Waterloo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Earl’s Court</td>
<td style="text-align: left;">Turnham Green</td>
</tr>
<tr class="even">
<td style="text-align: left;">Green Park</td>
<td style="text-align: left;">Green Park</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-removed-stations-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-removed-stations" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(b) Betweenness Centrality</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Non-sequential</th>
<th style="text-align: left;">Sequential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bank and Monument</td>
<td style="text-align: left;">Bank and Monument</td>
</tr>
<tr class="even">
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Stratford</td>
<td style="text-align: left;">Canada Water</td>
</tr>
<tr class="even">
<td style="text-align: left;">Baker Street</td>
<td style="text-align: left;">West Hampstead</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oxford Circus</td>
<td style="text-align: left;">Earl’s Court</td>
</tr>
<tr class="even">
<td style="text-align: left;">Euston</td>
<td style="text-align: left;">Oxford Circus</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Earl’s Court</td>
<td style="text-align: left;">Shepherd’s Bush</td>
</tr>
<tr class="even">
<td style="text-align: left;">Shadwell</td>
<td style="text-align: left;">Bakes Street</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Waterloo</td>
<td style="text-align: left;">Acton Town</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Kensington</td>
<td style="text-align: left;">Stratford</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-removed-stations-3" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-removed-stations" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(c) Closeness Centrality</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Non-sequential</th>
<th style="text-align: left;">Sequential</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Holborn</td>
<td style="text-align: left;">Holborn</td>
</tr>
<tr class="even">
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
<td style="text-align: left;">King’s Cross St.&nbsp;Pancras</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tottenham Court Road</td>
<td style="text-align: left;">Embankment</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oxford Circus</td>
<td style="text-align: left;">Waterloo</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leicester Square</td>
<td style="text-align: left;">London Bridge</td>
</tr>
<tr class="even">
<td style="text-align: left;">Picadilly Circus</td>
<td style="text-align: left;">West Hampstead</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Charing Cross</td>
<td style="text-align: left;">Clapham Junction</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chancery Lane</td>
<td style="text-align: left;">Mile End</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Covent Garden</td>
<td style="text-align: left;">Stratford</td>
</tr>
<tr class="even">
<td style="text-align: left;">Embankment</td>
<td style="text-align: left;">Notting Hill Gate</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>The change in performance measures caused by the node removal is as illustrated in <a href="#fig-node-removal-measures">Figure&nbsp;1</a>, and the final network is mapped in <a href="#fig-node-removal-network">Figure&nbsp;2</a></p>
<div id="fig-node-removal-measures" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/node_removal_measures.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;1: The change in the performance measures as a result of node removal on the London Underground Network.</figcaption>
</figure>
</div>
<div id="fig-node-removal-network" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/node_removal_results.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;2: The map of the London Underground Network after each node removal strategy.</figcaption>
</figure>
</div>
<section id="discussions" class="level5 unnumbered">
<h5 class="unnumbered anchored" data-anchor-id="discussions">Discussions</h5>
<p>Based on the two performance measures, we can conclude that the strategy more effective to study resilience is the sequential removal. This strategy evaluates the network after the previous removal, thus able to identify the most important node at the point of removal. Since the characteristics of the network change after removing one node, the node with the next highest centrality measure may not be the most important node after removal of one node. One obvious example can be observed in the non-sequential removal based on highest closeness centrality measures, where the stations located in the centre of London are removed altogether; the impact to the network after the removal of the first few nodes have significantly lowered the importance to the network in this area. By assessing the importance of node at each step, the sequential removal is capable of identifying the hidden nodes that gain importance when the most obvious nodes have been removed, which may need improvements if we were to prepare for emergency situations.</p>
<p>Comparing between the centrality measures, the betweenness centrality reflects the importance of stations the most. When removing multiple stations based on highest centrality measures, following the betweenness centrality lead to the largest decrease in both of the performance measures. Since a high betweenness centrality indicates high number of flows through the node, removing this node will force the flows to divert using different routes, requiring a higher cost to reach the destination. Given that connecting two points is the fundamental function of a transport network, the betweenness centrality directly addresses the importance regarding this aspect.</p>
<p>It is worth noting that the degree centrality has identified the first station to remove that impacts the performance the most, and has outperformed the closeness centrality until the 6th station. Further investigation is required to identify whether the stations at the centre of the network (high closeness centrality) or terminal stations with many lines operating (high degree centrality) is more critical to the performance of the whole network.</p>
<p>For the comparison of the impact measure, the efficiency appears to be a better evaluation of the performance of the network. The size of the largest connected component does not take into account how well-connected the nodes are within the largest component, therefore unable to assess the impact of station removal unless the removal disconnects a portion of the network. In an underground network where multiple lines intersect at multiple points, removal of a few stations may not always disconnect stations from networks (especially in the central part of the network) but may impact the efficiency. On the other hand, efficiency measures the actual distance between origin and destination, thus the impact on the actual flow within the network is more accurately reported.</p>
</section>
</section>
</section>
<section id="flows-weighted-network" class="level3">
<h3 class="anchored" data-anchor-id="flows-weighted-network">Flows: Weighted Network</h3>
<p>In this section, a weighted network with the flows assigned to the links between stations will be considered. Based on the Transport for London OD data <span class="citation" data-cites="transportforlondon2021">(<a href="#ref-transportforlondon2021" role="doc-biblioref">Transport for London, 2021</a>)</span>, the morning peak flows have been assigned assuming that all flows use the shortest path, considering the length of each edge. Hereinafter, <span class="math inline">\(w_{ij}\)</span> is the flow on the link between adjacent stations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> (sum of both directions).</p>
<section id="centrality-measures-1" class="level4">
<h4 class="anchored" data-anchor-id="centrality-measures-1">Centrality Measures</h4>
<p>We will consider whether the 3 centrality measures we have identified in the previous section need adjustments to be applied in the context of the weighted network.</p>
<p>The degree centrality as the number of connected stations continues to be a valid figure. Theoretically, a flow-weighted version of degree centrality <a href="#eq-degree-centrality">Equation&nbsp;1</a> can be defined as</p>
<p><span id="eq-deg-weighted"><span class="math display">\[
s_i = \sum_j A_{ij}w_{ij}
\tag{4}\]</span></span></p>
<p>which is a measure defined as the strength <span class="math inline">\(s_i\)</span> <span class="citation" data-cites="lee2008">(<a href="#ref-lee2008" role="doc-biblioref">Lee <em>et al.</em>, 2008</a>)</span>. This quantifies the amount of flow that passes through each node - which is highly related to the betweenness centrality in the weighted context.</p>
<p>The betweenness centrality considering flows, given <span class="math inline">\(T_{ij}\)</span> as the number of flows from node <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span>, can be proposed as follows:</p>
<p><span id="eq-bet-weighted"><span class="math display">\[
x'_i = \sum_{st} \frac{n^i_{st}}{g_{st}}T_{st}
\tag{5}\]</span></span></p>
<p>Recalling the strength <a href="#eq-deg-weighted">Equation&nbsp;4</a> was the sum of all flows using the links that connect to the node, and <a href="#eq-bet-weighted">Equation&nbsp;5</a> only considers the flows that passes through (not beginning nor terminating), these two centrality measures fulfill the following relationship</p>
<p><span class="math display">\[
s_i = x'_i + O_i + D_i
\]</span></p>
<p>where <span class="math inline">\(O_i, D_i\)</span> is the number of flows originating and terminating at node <span class="math inline">\(i\)</span>, respectively.</p>
<p>When considering the closeness centrality with regards to the number of flows, simply considering <span class="math inline">\(T_{ij}\)</span> in <a href="#eq-closeness-centrality">Equation&nbsp;3</a> as <span class="math inline">\(C'_i = \frac{\sum_j T_{ij}}{\sum_j T_{ij}d_{ij}}\)</span> will return the average distance travelled by the user of the station, which does not correspond to the principle of closeness centrality. (This figure may be larger in the city centre where people are willing to travel from far away, or at the periphery of the network where passengers need to travel long distances in general.) Instead, by defining the social distance of links as the inverse of the flows, and <span class="math inline">\(u_{ij}\)</span> as the shortest social distance between nodes <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, the closeness centrality considering weights can be defined as</p>
<p><span class="math display">\[
C''_i = \frac{n-1}{\sum_j u_{ij}}
\]</span></p>
</section>
<section id="impact-measures-1" class="level4">
<h4 class="anchored" data-anchor-id="impact-measures-1">Impact Measures</h4>
<p>We will consider the need for adjusting the impact measures in <a href="#tbl-delta-performance">Table&nbsp;4</a> when considering the passenger flows.</p>
<p>The size of the largest connected components is a valid measure in a weighted network, since it does not consider the flows between nodes. If the weight of the edges are to be incorporated to quantify the <em>connected-ness</em> of the nodes, a similar performance measure would be the maximum number of journeys that can be completed within a connected component.</p>
<p>For the network efficiency, each of the distances should be weighted according to the number of passengers who travel between the two nodes. The efficiency should also account for the flows between points. The equation in <a href="#tbl-delta-performance">Table&nbsp;4</a> should be adjusted using <span class="math inline">\(T_{ij}\)</span> as:</p>
<p><span class="math display">\[
E(G) = \frac{1}{n(n-1)} \sum_{i \ne j} \frac{T_{ij}}{d_{ij}}
\]</span></p>
</section>
<section id="node-removal-1" class="level4">
<h4 class="anchored" data-anchor-id="node-removal-1">Node Removal</h4>
</section>
</section>
</section>
<section id="part-2-spatial-interaction-models" class="level2">
<h2 class="anchored" data-anchor-id="part-2-spatial-interaction-models">Part 2: Spatial Interaction Models</h2>
<p>In the second part, we will analyse the OD matrix of the London Underground. The variables will be denoted as follows:</p>
<ul>
<li><span class="math inline">\(T_{ij}\)</span>: estimated flow from station <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span></li>
<li><span class="math inline">\(T\)</span>: total flow within a network, thus <span class="math inline">\(T = \sum_{i,j} T_{ij}\)</span></li>
<li><span class="math inline">\(d_{ij}\)</span>: distance between stations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> - the cost function is a function of <span class="math inline">\(d_{ij}\)</span> hence denoted as <span class="math inline">\(f(d_{ij})\)</span></li>
<li><span class="math inline">\(O_i\)</span>, <span class="math inline">\(D_j\)</span>: attractors (often population) at the origin and destination</li>
</ul>
<section id="models-and-calibration" class="level3">
<h3 class="anchored" data-anchor-id="models-and-calibration">Models and Calibration</h3>
<section id="family-of-spatial-interaction-models" class="level4">
<h4 class="anchored" data-anchor-id="family-of-spatial-interaction-models">Family of Spatial Interaction Models</h4>
<p>The family of spatial interaction models are as follows:</p>
<p>The <strong>unconstrained model</strong> only constrains the model with matching the total flows with the observed value, written as</p>
<p><span class="math display">\[
T_{ij} = K O^{\alpha}_i D^{\gamma}_j f(c_{ij})
\]</span></p>
<p>where <span class="math inline">\(K\)</span> is the constant</p>
<p><span class="math display">\[
K = \frac{T}{\sum_i \sum_j O^{\alpha}_i D^{\gamma}_j f(d_{ij})}
\]</span></p>
<p>so that the total number of journeys are constrained.</p>
<p>The <strong>singly constrained model</strong> constrains the total number of observations for each component at the origin or the destination. The origin constrained model fixes the total number of journeys at the origin, as:</p>
<p><span id="eq-orig"><span class="math display">\[
T_{ij} = A_i O^{\alpha}_i D^{\gamma}_j f(d_{ij})
\tag{6}\]</span></span></p>
<p>The parameter <span class="math inline">\(A_i\)</span> is determined so that the total at the origin is constrained, that is:</p>
<p><span class="math display">\[
\sum_j T_{ij} = O_i \therefore A_i = \frac{1}{\sum_j D_j f(d_{ij})}
\]</span></p>
<p>Similarly, the <strong>destination constrained model</strong> constrains the total at the destination.</p>
<p><span class="math display">\[
T_{ij} = O^{\alpha}_i B_j D^{\gamma}_j f(c_{ij}) \quad
\text{where } \left (B_j = \frac{1}{\sum_i O_i f(c_{ij})} \right)
\]</span></p>
<p>The <strong>doubly constrained model</strong> constrains both the total at the origin and destination.</p>
<p><span id="eq-dbl"><span class="math display">\[
T_{ij} = A_i O^{\alpha}_i B_j D^{\gamma}_j \exp(-\beta d_{ij})
\tag{7}\]</span></span></p>
</section>
<section id="calibration-of-cost-function" class="level4">
<h4 class="anchored" data-anchor-id="calibration-of-cost-function">Calibration of Cost Function</h4>
<p>The dataset used for analysis have the following data for every origin-destination pair for the London Underground Stations.</p>
<ul>
<li>population of origin</li>
<li>jobs at the destination</li>
<li>distance between origin and destination</li>
<li>flow from the origin to the destination</li>
</ul>
<p>Using this dataset, we will use the doubly constrained model to estimate the best cost function and parameters by comparing with the observed flow. Constraining both the total journeys for both the origin and destination will enable the full utilisation of observed data, enabling a most accurate calibration of the cost function.</p>
<p>The doubly constrained model after a logarithm transformation of <a href="#eq-dbl">Equation&nbsp;7</a> into a Poisson expression can be written as:</p>
<p><span class="math display">\[
\ln(T_{ij}) = \ln A_i + \ln O^{\alpha}_i + \ln B_j + \ln D^{\gamma}_j + \ln f(d_{ij}) \\
\]</span></p>
<p>We will compare the negative exponential and inverse power relationships as the cost function <span class="math inline">\(f(d_{ij})\)</span> as follows:</p>
<p><span class="math display">\[
f(d_{ij}) =
\begin{cases}
\exp(-\beta d_{ij}) \text{ (Negative Exponential)} \\
d^{-\beta}_{ij}  \text{ (Inverse Power)}
\end{cases}
\]</span></p>
<p>For each cost function, we have run the Poisson Regression to calculate the optimal parameter <span class="math inline">\(\beta\)</span>.</p>
<table class="table">
<caption>Comparison of results for the doubly constrained model using inverse power and negative exponential cost functions.</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Cost Function</th>
<th>Parameter <span class="math inline">\(\beta\)</span></th>
<th><span class="math inline">\(R^2\)</span> value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Negative exponential <span class="math inline">\(f(d_{ij}) = \exp(-\beta d_{ij})\)</span></td>
<td><span class="math inline">\(\beta = 1.543 \times 10^{-4}\)</span></td>
<td><span class="math inline">\(R^2 = 0.4979\)</span></td>
</tr>
<tr class="even">
<td>Inverse Power <span class="math inline">\(f(d_{ij}) = d^{-\beta}_{ij}\)</span></td>
<td><span class="math inline">\(\beta = 9.096 \times 10^{-1}\)</span></td>
<td><span class="math inline">\(R^2 = 0.4077\)</span></td>
</tr>
</tbody>
</table>
<p>From these results, the negative exponential model for the cost function has a better fit to the observed flows. When considering the scenarios, the cost function</p>
<p><span id="eq-beta"><span class="math display">\[
f(d_{ij}) = \exp(-\beta d_{ij}) \quad (\beta = -1.543 \times 10^{-4})
\tag{8}\]</span></span></p>
<p>will be used.</p>
</section>
</section>
<section id="scenarios" class="level3">
<h3 class="anchored" data-anchor-id="scenarios">Scenarios</h3>
<p>The scenarios we will observe in this report are summarised in <a href="#tbl-scenarios">Table&nbsp;6</a>.</p>
<div id="tbl-scenarios" class="anchored">
<table class="table">
<caption>Table&nbsp;6: The scenarios explored in this report</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Scenario</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Scenario A</td>
<td style="text-align: left;">Jobs at Canary Wharf decrease by 50 %</td>
</tr>
<tr class="even">
<td style="text-align: left;">Scenario B</td>
<td style="text-align: left;">Increase in cost of transport - considering 2 parameters</td>
</tr>
</tbody>
</table>
</div>
<p>Since scenario A involves the change in the characteristics of the destination, the origin constrained model is used for the analysis to preserve the number of commuters starting their journeys in each area.</p>
<section id="calibration-of-gamma" class="level4">
<h4 class="anchored" data-anchor-id="calibration-of-gamma">Calibration of <span class="math inline">\(\gamma\)</span></h4>
<p>Since the origin-constrained model will be used for the analysis of the scenarios, the gamma variable introduced in <a href="#eq-orig">Equation&nbsp;6</a> must be calibrated before applying to the new scenarios. <span class="math inline">\(\gamma\)</span> with the highest R-squared value for estimating the original flow will be used, resulting as follows:</p>
<p><span id="eq-gamma"><span class="math display">\[
\gamma = 7.556 \times 10^{-1} \quad (R^2 = 0.4680)
\tag{9}\]</span></span></p>
</section>
<section id="scenario-a" class="level4">
<h4 class="anchored" data-anchor-id="scenario-a">Scenario A</h4>
<p>We will first decrease the number of jobs at Canary Wharf by 50%, from the original 58,772 to 29,386. Using the origin-constrained model, the procedure is as follows:</p>
<ol type="1">
<li>Calculate the flow based on the origin-constrained model <span class="math inline">\(T_{ij} = A_i O_i D^{\gamma}_j \exp(-\beta d_{ij})\)</span> to retrieve the optimal <span class="math inline">\(\gamma\)</span> value for this dataset. The value for parameters <span class="math inline">\(\beta, \gamma\)</span> is derived from <a href="#eq-beta">Equation&nbsp;8</a> and <a href="#eq-gamma">Equation&nbsp;9</a>.</li>
<li>Reduce the number of jobs at Canary Wharf (transform <span class="math inline">\(D_j\)</span> into <span class="math inline">\(D'_j\)</span>)</li>
<li>Recalibrate the adjusted <span class="math inline">\(A'_i\)</span> parameter with the new distribution of using the relationship <span class="math inline">\(A'_i = \frac{1}{\sum_j D'^{\gamma}_j f(d_{ij})}\)</span></li>
<li>Calculate the new flows using the relationship <span class="math inline">\(T'_{ij} = A'_i O_i D'^{\gamma}_j \exp(-\beta d_{ij})\)</span></li>
</ol>
<p>Using the origin constrained model, we will observe how the destination of commuters changed in reaction to the decrease in jobs in Canary Wharf.</p>
<p>We have observed a significant drop in the number of journeys terminating at Canary Wharf from 47,690 in the original simulation to 29,496 in scenario A, which is 61.9 % of the original amount. As observable from <a href="#fig-OD-scenarioA">Figure&nbsp;3</a>, the decrease in the flows to Canary Wharf occured evenly among all origins, and has been redistributed into other destinations.</p>
<div id="fig-OD-scenarioA" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/OD_change_scenarioA.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Comparison of the flows of OD pairs the original simulation and the flows under scenario A.</figcaption>
</figure>
</div>
</section>
<section id="scenario-b" class="level4">
<h4 class="anchored" data-anchor-id="scenario-b">Scenario B</h4>
<p>We will consider 2 scenarios for the change in the cost of transport. Given the original parameter as <span class="math inline">\(\beta\)</span>, the parameters <span class="math inline">\(\beta_1, \beta_2\)</span> for the two scenarios B1 and B2 will be modified as shown in <a href="#eq-paramsB">Equation&nbsp;10</a> and <a href="#fig-paramsB">Figure&nbsp;4</a>.</p>
<p><span id="eq-paramsB"><span class="math display">\[
\begin{cases}
\beta_1 = 2 \beta \\
\beta_2 = 10 \beta
\end{cases}
\quad (\beta = -1.543 \times 10^{-4})
\tag{10}\]</span></span></p>
<div id="fig-paramsB" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/dist_decay.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Distance decay function for the original scenario and the two modified scenarios. This indicates the cost for travelling a fixed distance will be equivalent to that of travelling twice (B1) or 10 times (B2) the distance in the original model.</figcaption>
</figure>
</div>
<p>The flows between origin-destination pairs for each scenario, plotted by distance of journeys, are shown in <a href="#fig-OD-scenarioB">Figure&nbsp;5</a>. As the <span class="math inline">\(\beta\)</span> increases, the longer distance journeys are disencouraged, and the distribution of the distance of journeys become negatively skewed.</p>
<div id="fig-OD-scenarioB" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="img/OD_change_scenarioB.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Comparison of the distance of flows for scenario B and the original prediction.</figcaption>
</figure>
</div>
</section>
<section id="discussion" class="level4">
<h4 class="anchored" data-anchor-id="discussion">Discussion</h4>
<p>In this section, we will discuss the impact of each scenario on the distribution of flows in the underground network. The measurements summarised in <a href="#tbl-measurements">Table&nbsp;7</a> are considered to examine the changes that occured as a result of each scenario.</p>
<div id="tbl-measurements" class="anchored">
<table class="table">
<caption>Table&nbsp;7: Measurements consider to quantify the change in flows for each scenario. <span class="math inline">\(T'_{ij}\)</span> is the number of journeys from station <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> under the scenario.</caption>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Measurement</th>
<th>Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Quantity of change in destination <span class="math inline">\(T_{\text{diff}}\)</span></td>
<td>The number of flows that have different destination compared to the original scenario. A larger number of change in destination indicate larger impact.</td>
</tr>
<tr class="even">
<td>Mean distance of journeys <span class="math inline">\(\bar{\delta^X}\)</span></td>
<td>The mean distance of all journeys simulated in each scenario. A larger change in the distance compared to the original simulation indicate larger impact.</td>
</tr>
</tbody>
</table>
</div>
<p>For each scenario, the values for these measurements are calculated as shown in <a href="#tbl-measure-scenarios">Table&nbsp;8</a>. The number of destinations changed and the change in the mean distance of journeys both indicate that scenario B2 had the largest impact on the number of flows, and scenario A being the least impactful.</p>
<div id="tbl-measure-scenarios" class="anchored">
<table class="table">
<caption>Table&nbsp;8: Value of measurements for each scenario.</caption>
<thead>
<tr class="header">
<th>Scenario</th>
<th><span class="math inline">\(T_{\text{diff}}\)</span></th>
<th><span class="math inline">\(\bar{\delta}\)</span> [m]</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Scenario A</td>
<td>18,193 (1.2 % of total flows)</td>
<td>8,579</td>
</tr>
<tr class="even">
<td>Scenario B1</td>
<td>346,503 (22.47 %)</td>
<td>6,030</td>
</tr>
<tr class="odd">
<td>Scenario B2</td>
<td>1,222,191 (79.25 %)</td>
<td>1,613</td>
</tr>
<tr class="even">
<td>Original Simulation</td>
<td>Total flows: 1,542,283</td>
<td>8,583</td>
</tr>
</tbody>
</table>
</div>
<p>The intervention to the travel cost (scenario B) directly impacts all OD pairs, while the reduction of jobs in one area (scenario A) only impacts journeys that end at the station affected. This different nature of the interventions dictate the magnitude of change it causes; thus scenario B has a larger impact on the flows on the network as a whole. Recalling the impact of scenario A on Canary Wharf was a 39 % decrease in the total inflows, this figure falls between scenarios B1 and B2 in terms of <span class="math inline">\(T_{\text{diff}}\)</span>. Since <span class="math inline">\(\bar{\delta}\)</span> remains unchanged the impact on Canary Wharf is difficult to compare between scenarios A and B1, scenario B2 has the largest impact even if the focus is on Canary Wharf. To conclude, a drastic impact on the cost function has more impact throughout the network compared to a large change in the demand in a particular area. Impact of the actual changes in the underground fares that occured should be investigated to compare with the results of our model.</p>
<hr>
<p>Word count: x words</p>
<p>GitHub repository (as hyperlink): <a href="https://github.com/sokimura39/Urban_Simulation_Report">Urban_Simulation_Report</a></p>
<div style="page-break-after: always;"></div>
</section>
</section>
</section>
<section id="references" class="level2 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-latora2001" class="csl-entry" role="listitem">
Latora, V. and Marchiori, M. (2001) <span>“Efficient <span>Behavior</span> of <span>Small-World Networks</span>,”</span> <em>Physical Review Letters</em>, 87(19), p. 198701. doi: <a href="https://doi.org/10.1103/PhysRevLett.87.198701">10.1103/PhysRevLett.87.198701</a>.
</div>
<div id="ref-latora2007" class="csl-entry" role="listitem">
Latora, V. and Marchiori, M. (2007) <span>“A measure of centrality based on network efficiency,”</span> <em>New Journal of Physics</em>, 9(6), p. 188. doi: <a href="https://doi.org/10.1088/1367-2630/9/6/188">10.1088/1367-2630/9/6/188</a>.
</div>
<div id="ref-lee2008" class="csl-entry" role="listitem">
Lee, K. <em>et al.</em> (2008) <span>“Statistical analysis of the <span>Metropolitan Seoul Subway System</span>: <span>Network</span> structure and passenger flows,”</span> <em>Physica A: Statistical Mechanics and its Applications</em>, 387(24), pp. 6231–6234. doi: <a href="https://doi.org/10.1016/j.physa.2008.06.035">10.1016/j.physa.2008.06.035</a>.
</div>
<div id="ref-paaswell2012" class="csl-entry" role="listitem">
Paaswell, R. E. (2012) <span>“Approaches to <span>Infrastructure Redevelopment</span>, <span>WTC</span>, <span>Lower NYC</span> and the <span>Region</span>,”</span> pp. 215–226. doi: <a href="https://doi.org/10.1061/40717(148)18">10.1061/40717(148)18</a>.
</div>
<div id="ref-transportforlondon2021" class="csl-entry" role="listitem">
Transport for London (2021) <span>“Project <span>NUMBAT</span>.”</span>
</div>
<div id="ref-wyatt2002" class="csl-entry" role="listitem">
Wyatt, E. (2002) <span>“Subway <span>Service</span> to <span>Resume On Routes Closed After</span> 9/11,”</span> <em>The New York Times</em>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>